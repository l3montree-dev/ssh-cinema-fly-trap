FROM ubuntu:22.04

LABEL key="Erster Testcontainer mit SSH"

RUN apt update && apt install -y openssh-server curl wget nano vim  \
    && sed -i 's/#Port 22/Port 60000/' /etc/ssh/sshd_config \
    && sed -i 's/#PermitRootLogin prohibit-password/PermitRootLogin yes/' /etc/ssh/sshd_config \
    && echo 'root:root' | chpasswd \
    && useradd -m -s /bin/bash user \
    && echo 'user:password' | chpasswd \
    && mkdir -p /run/sshd

RUN apt-get install -y python3-pip && \
    pip3 install asciinema

RUN mkdir -p /home/user/webapp \
    && mkdir -p /redorcings && chmod 777 /redorcings

COPY fake_env.md /home/user/webapp/.env

EXPOSE 60000

VOLUME [ "/recordings" ]

CMD ["/usr/sbin/sshd","-D"]